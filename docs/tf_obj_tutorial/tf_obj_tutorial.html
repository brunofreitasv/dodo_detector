
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>TensorFlow Object Detection Model Training &#8212; dodo detector 0.2 documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="dodo_detector package" href="../dodo_detector.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../dodo_detector.html" title="dodo_detector package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">dodo detector 0.2 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tensorflow-object-detection-model-training">
<h1>TensorFlow Object Detection Model Training<a class="headerlink" href="#tensorflow-object-detection-model-training" title="Permalink to this headline">¶</a></h1>
<p>This is a summary of <a class="reference external" href="https://medium.com/towards-data-science/how-to-train-your-own-object-detector-with-tensorflows-object-detector-api-bec72ecfe1d9">this nice
tutorial</a>.</p>
<ol class="arabic simple">
<li><a class="reference external" href="https://www.tensorflow.org/install/">Install TensorFlow</a>.</li>
<li>Download the TensorFlow <a class="reference external" href="https://github.com/tensorflow/models">models repository</a>.</li>
</ol>
<div class="section" id="annotating-the-dataset">
<h2>Annotating the dataset<a class="headerlink" href="#annotating-the-dataset" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Install <a class="reference external" href="https://github.com/tzutalin/labelImg">labelImg</a>. This is
a Python package, you can install via pip, but the one from GitHub is
better. It saves annotations in the PASCAL VOC format.</li>
<li>Annotate your dataset using labelImg.</li>
<li>Use <a class="reference external" href="https://github.com/datitran/raccoon_dataset/blob/master/xml_to_csv.py">this script</a>
to convert the XML files generated by labelImg into a single CSV
file.</li>
<li>Separate the CSV file into two, one with training examples and one
with evaluation examples. Images should be selected randomly, making
sure that objects from all classes are present in both of them. The
usual proportions are 75 to 80% training and the rest to the
evaluation dataset.</li>
<li>Use <a class="reference external" href="https://github.com/datitran/raccoon_dataset/blob/master/generate_tfrecord.py">this script</a>
to convert the two CSV files (eg. train.csv and eval.csv) into
TFRecord files (eg. train.record and eval.record), the data format
TensorFlow is most familiar with.</li>
</ol>
</div>
<div class="section" id="traversing-the-text-file-hell">
<h2>Traversing the text file hell…<a class="headerlink" href="#traversing-the-text-file-hell" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple" start="6">
<li>Create a label map, like <a class="reference external" href="https://github.com/tensorflow/models/tree/master/research/object_detection/data">one of these</a>.
Make sure class numbers are exactly the ones that were used when
creating the TFRecords.</li>
<li>Download one of the neural network models provided in <a class="reference external" href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/detection_model_zoo.md">this page</a>.
The ones trained in the MSCoco dataset are the best ones, since they
were also trained on objects.</li>
<li>Provide a training pipeline, which is a <code class="docutils literal notranslate"><span class="pre">config</span></code> that usually comes
in the tar.gz file downloaded in the last step. If they don’t, they
can be found
<a class="reference external" href="https://github.com/tensorflow/models/tree/master/research/object_detection/samples/configs">here</a>
(they need some tweaking before using, for example, changing number
of classes). A tutorial on how to create your own
<a class="reference external" href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/configuring_jobs.md">here</a>.<ul>
<li>The pipeline config file has some fields that must be adjusted before
training is started. Its header describes which ones. Usually, they
are the fields that point to the label map, the training and
evaluation directories and the neural network checkpoint. In case you
downloaded one of the models provided in <a class="reference external" href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/detection_model_zoo.md">this page</a>,
you should untar the <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> file and point the checkpoint path
inside the pipeline config file to the “untarred” directory of the
model (see <a class="reference external" href="https://stackoverflow.com/a/45363576/1245214">this answer</a> for help).</li>
<li>You should also check the number of classes. MSCoco has 90 classes,
but your problem may have more or less.</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="training-the-network">
<h2>Training the network<a class="headerlink" href="#training-the-network" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Train the model.
<a class="reference external" href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/running_locally.md">This is how you do it locally</a>.
<strong>Optional:</strong> in order to check training progress, TensorBoard can be
started pointing its <code class="docutils literal notranslate"><span class="pre">--logdir</span></code> to the <code class="docutils literal notranslate"><span class="pre">--train_dir</span></code> of
object_detection/train.py.</li>
<li>Export the network, like
<a class="reference external" href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/exporting_models.md">this</a>.</li>
<li>Use the exported <code class="docutils literal notranslate"><span class="pre">.pb</span></code> in your object detector.</li>
</ol>
</div>
<div class="section" id="tips">
<h2>Tips<a class="headerlink" href="#tips" title="Permalink to this headline">¶</a></h2>
<p>In the <em>data augmentation</em> section of the training pipeline, some
options can be added or removed to try and make the training better.
Some of the options are listed
<a class="reference external" href="https://stackoverflow.com/a/46901051">here</a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">TensorFlow Object Detection Model Training</a><ul>
<li><a class="reference internal" href="#annotating-the-dataset">Annotating the dataset</a></li>
<li><a class="reference internal" href="#traversing-the-text-file-hell">Traversing the text file hell…</a></li>
<li><a class="reference internal" href="#training-the-network">Training the network</a></li>
<li><a class="reference internal" href="#tips">Tips</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../dodo_detector.html"
                        title="previous chapter">dodo_detector package</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/tf_obj_tutorial/tf_obj_tutorial.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../dodo_detector.html" title="dodo_detector package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">dodo detector 0.2 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Douglas De Rizzo Meneghetti.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>